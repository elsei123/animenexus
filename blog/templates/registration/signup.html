{% extends "blog/base.html" %}

{% block meta_description %}
Create a new AnimeNexus account
{% endblock %}

{% block title %}
Sign Up | AnimeNexus
{% endblock %}

{% block content %}
  <section class="auth-section">
    <h1>Sign Up</h1>

    <form method="post" class="auth-form" novalidate>
      {% csrf_token %}
      {{ form.non_field_errors }}

      {# preserva redirect se veio de ?next=... #}
      {% if request.GET.next %}
        <input type="hidden" name="next" value="{{ request.GET.next }}">
      {% endif %}

      <div class="form-group">
        {{ form.username.label_tag }}
        {{ form.username.as_widget(attrs={
          "autocomplete": "username",
          "required": "required"
        }) }}
        {% if form.username.help_text %}
          <small id="help-username" class="form-help">{{ form.username.help_text }}</small>
        {% endif %}
        {{ form.username.errors }}
      </div>

      <div class="form-group">
        {{ form.email.label_tag }}
        {{ form.email.as_widget(attrs={
          "type": "email",
          "autocomplete": "email",
          "required": "required"
        }) }}
        {% if form.email.help_text %}
          <small id="help-email" class="form-help">{{ form.email.help_text }}</small>
        {% endif %}
        {{ form.email.errors }}
      </div>

      <div class="form-group">
        {{ form.first_name.label_tag }}
        {{ form.first_name.as_widget(attrs={
          "autocomplete": "given-name",
          "required": "required"
        }) }}
        {{ form.first_name.errors }}
      </div>

      <div class="form-group">
        {{ form.last_name.label_tag }}
        {{ form.last_name.as_widget(attrs={
          "autocomplete": "family-name",
          "required": "required"
        }) }}
        {{ form.last_name.errors }}
      </div>

      <div class="form-group">
        {{ form.date_of_birth.label_tag }}
        {{ form.date_of_birth.as_widget(attrs={
          "autocomplete": "bday"
        }) }}
        {% if form.date_of_birth.help_text %}
          <small id="help-dob" class="form-help">{{ form.date_of_birth.help_text }}</small>
        {% endif %}
        {{ form.date_of_birth.errors }}
      </div>

      <div class="form-group">
        {{ form.password1.label_tag }}
        {{ form.password1.as_widget(attrs={
          "autocomplete": "new-password",
          "required": "required"
        }) }}
        {% if form.password1.help_text %}
          <small id="help-password1" class="form-help">{{ form.password1.help_text|safe }}</small>
        {% endif %}
        {{ form.password1.errors }}
      </div>

      <div class="form-group">
        {{ form.password2.label_tag }}
        {{ form.password2.as_widget(attrs={
          "autocomplete": "new-password",
          "required": "required"
        }) }}
        {% if form.password2.help_text %}
          <small id="help-password2" class="form-help">{{ form.password2.help_text|safe }}</small>
        {% endif %}
        {{ form.password2.errors }}
      </div>

      <div class="form-actions">
        <button type="submit" class="btn btn-primary">Create Account</button>
      </div>
    </form>

    <p class="auth-switch">
      Already have an account?
      <a href="{% url 'login' %}{% if request.GET.next %}?next={{ request.GET.next|urlencode }}{% endif %}">
        Log in here
      </a>
    </p>
  </section>
{% endblock %}

